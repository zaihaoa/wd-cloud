<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wd.system.basic.mapper.CommonLogMapper">


    <select id="pageCount" resultType="java.lang.Integer">
        select count(*)
        from sys_common_log
        <include refid="Page_Condition"/>
    </select>

    <select id="pageList" resultType="com.wd.system.basic.domain.dto.CommonLogPageDTO">
        select
        id as id,
        business_type as businessType,
        business_id as businessId,
        operation_type as operationType,
        content as content,
        create_user_id as createUserId,
        update_user_id as updateUserId,
        create_time as createTime,
        update_time as updateTime
        from sys_common_log
        <include refid="Page_Condition"/>

        order by createTime desc, id desc

        <bind name="limitStart" value="(param.current lte 1) ? 0 : ((param.current - 1) * param.size)"/>
        LIMIT #{limitStart}, #{param.size}
    </select>

    <sql id="Page_Condition">
        <where>
            <if test="param.businessType != null and param.businessType != ''">
                and `business_type` = #{param.businessType}
            </if>
            <if test="param.businessId != null">
                and `business_id` = #{param.businessId}
            </if>
        </where>
    </sql>
</mapper>
